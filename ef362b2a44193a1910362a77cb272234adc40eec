{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "481f61d4_606b23f6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1402878
      },
      "writtenOn": "2022-05-10T12:07:08Z",
      "side": 1,
      "message": "thanks for that excellent idea. Perhaps we can use `TAR_OPTIONS` to not repeat ourselves and to propagate this to all `tar` invocations.",
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb1ef7e4_5f0ee825",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-05-16T23:05:13Z",
      "side": 1,
      "message": "(or a shell `alias`?)",
      "parentUuid": "481f61d4_606b23f6",
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b75d4b83_2c50352a",
        "filename": "build.sh",
        "patchSetId": 1
      },
      "lineNbr": 899,
      "author": {
        "id": 1402878
      },
      "writtenOn": "2022-05-10T12:07:08Z",
      "side": 1,
      "message": "is that not effectively leading to unpacking as root (or the attempt of that)?",
      "range": {
        "startLine": 899,
        "startChar": 50,
        "endLine": 899,
        "endChar": 69
      },
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d441acdf_63881291",
        "filename": "build.sh",
        "patchSetId": 1
      },
      "lineNbr": 899,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-05-10T19:55:00Z",
      "side": 1,
      "message": "(if you\u0027re _not_ root, the default is to ignore owner/group when un-tarring. and if you _are_ root ... :-) so this should be fine.)",
      "parentUuid": "b75d4b83_2c50352a",
      "range": {
        "startLine": 899,
        "startChar": 50,
        "endLine": 899,
        "endChar": 69
      },
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5c69796_87c323da",
        "filename": "build.sh",
        "patchSetId": 1
      },
      "lineNbr": 899,
      "author": {
        "id": 1069238
      },
      "writtenOn": "2022-05-10T21:19:09Z",
      "side": 1,
      "message": "Both GNU tar and bsdtar (FreeBSD / libarchive) only preserve permissions and owner/group when extracting as root so it doesn\u0027t normally make a difference when extracting as a regular user. When extracting as root, it\u0027s best if owner/group are set to 0 because that\u0027s portable and safe. It\u0027s also simpler to use numeric 0 instead of storing the username / group name (root) which is why --numeric-owner is passed.\n\nAn alternative would be using zip instead of tar which is what\u0027s done in most of AOSP (zips for factory images, fastboot image zip, target files, symbols, otatools, etc.) but the per-file compression will result in larger files even compared to using DEFLATE for tar via tar.gz.\n\nzip/unzip commands on Linux distributions are also a dead project with serious unfixed bugs including serious security vulnerabilities (https://infozip.sourceforge.net/) and it\u0027s best to avoid them.\n\nAOSP has soong_zip implemented in Go as part of soong and the kernel depends on the AOSP build-tools repository so it could use that, but it\u0027ll unnecessarily use more space and rules out switching to tar.zst from tar.gz to save some space in archives.\n\nWe use bsdtar (libarchive) in the GrapheneOS CLI installation instructions since Windows and macOS both provide it as their tar command and most Linux distributions have it available as bsdtar. Windows bsdtar is crippled and only supports zip/tar/tar.gz with support for 7z, xz, zst and the other formats but it does work for CLI unzipping. bsdtar isn\u0027t installed on most Linux distributions other than Arch Linux by default though.",
      "parentUuid": "d441acdf_63881291",
      "range": {
        "startLine": 899,
        "startChar": 50,
        "endLine": 899,
        "endChar": 69
      },
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45c3c9e0_23bf819f",
        "filename": "build.sh",
        "patchSetId": 1
      },
      "lineNbr": 899,
      "author": {
        "id": 1069238
      },
      "writtenOn": "2022-05-10T21:29:14Z",
      "side": 1,
      "message": "\u003e with support for 7z, xz, zst and the other formats\n\ns/with/without/\n\nMarking thread as resolved.",
      "parentUuid": "e5c69796_87c323da",
      "range": {
        "startLine": 899,
        "startChar": 50,
        "endLine": 899,
        "endChar": 69
      },
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28903a10_ece3e685",
        "filename": "build.sh",
        "patchSetId": 1
      },
      "lineNbr": 899,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-05-10T21:29:26Z",
      "side": 1,
      "message": "(we have a libziparchive-based unzip already in the build-tools prebuilts, but no-one\u0027s written zip yet, in part because it seemed like the build system would stick with soong_zip...)",
      "parentUuid": "e5c69796_87c323da",
      "range": {
        "startLine": 899,
        "startChar": 50,
        "endLine": 899,
        "endChar": 69
      },
      "revId": "ef362b2a44193a1910362a77cb272234adc40eec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}