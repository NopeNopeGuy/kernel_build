{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b0158963_8cdc2d78",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1961395
      },
      "writtenOn": "2022-11-07T11:49:05Z",
      "side": 1,
      "message": "just to double check, does this work in `android-mainline` too?",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c037470f_173c3e8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1041813
      },
      "writtenOn": "2022-11-07T11:51:24Z",
      "side": 1,
      "message": "Sorry, I have not checked with the android-mainline yet, will check now.",
      "parentUuid": "b0158963_8cdc2d78",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f67d9b2e_d833474f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1041813
      },
      "writtenOn": "2022-11-07T13:17:21Z",
      "side": 1,
      "message": "the db845c does not boot for some reason, will check more:\n```\n[    1.942182][    T1] init: Loaded kernel module /lib/modules/arm_smmu.ko\n[    1.949111][    T1] init: Loading module /lib/modules/ath.ko with args \u0027\u0027\n[    1.956238][    T1] ath: Unknown symbol reg_initiator_name (err -2)\n[    1.962599][    T1] ath: Unknown symbol wiphy_apply_custom_regulatory (err -2)\n[    1.969908][    T1] ath: Unknown symbol ieee80211_get_channel_khz (err -2)\n[    1.976865][    T1] ath: Unknown symbol freq_reg_info (err -2)\n[    1.993225][    T1] init: Failed to insmod \u0027/lib/modules/ath.ko\u0027 with args \u0027\u0027: No such file or diy\n[    2.002863][    T1] init: LoadWithAliases was unable to load ath\n[    2.009576][    T1] init: Failed to load kernel modules\n[    2.015642][    T1] init: InitFatalReboot: signal 6\n[    2.035749][    T1] init:   #00 pc 0000000000315bd0  /init (unwindstack::AndroidLocalUnwinder::In)\n[    2.055226][    T1] init:   #01 pc 000000000030a40c  /init (android::init::InitFatalReboot(int)+2)\n[    2.068326][    T1] init:   #02 pc 000000000030aac0  /init (android::init::InstallRebootSignalHan)\n[    2.083931][    T1] init:   #03 pc 0000000000000874  [vdso]\n[    2.089587][    T1] init:   #04 pc 00000000004c0730  /init (abort+176) (BuildId: 294889f837e5cfad)\n[    2.100050][    T1] init:   #05 pc 000000000030fcdc  /init (android::init::InitAborter(char const)\n[    2.113418][    T1] init:   #06 pc 00000000004827a0  /init (android::base::SetAborter(std::__1::f)\n[    2.131663][    T1] init:   #07 pc 0000000000481fa4  /init (android::base::LogMessage::~LogMessag)\n[    2.145183][    T1] init:   #08 pc 0000000000300be8  /init (android::init::FirstStageMain(int, ch)\n[    2.158993][    T1] init:   #09 pc 00000000004bdf5c  /init (__real_libc_init(void*, void (*)(), i)\n[    2.178096][    T1] init: Reboot ending, jumping to kernel\n[    2.199274][    T1] arm-smmu 15000000.iommu: disabling translation\n[    2.206486][    T1] reboot: Restarting system with command \u0027bootloader\u0027\n```",
      "parentUuid": "c037470f_173c3e8c",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "50da9a92_4f4ed43a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1041813
      },
      "writtenOn": "2022-11-07T14:52:03Z",
      "side": 1,
      "message": "hmm, it does not break for the db845c android-mainline build, and the mac80211.ko and cfg80211.ko and the can ko files are copied successfully:\nhttps://ci.android.com/builds/submitted/9262377/kernel_db845c_kleaf/latest\n\nand comparing the BUILD.bazel between two branches, it seems the difference is that the cfg80211 and mac80211 modules are not in the define_db845c for the mainline branch. \nwhich means  Ulises Mendez Martinez\u0027s change here should work:\nhttps://android-review.googlesource.com/c/kernel/common/+/2289394\n\nSorry for the confusion, I will re-check again:(",
      "parentUuid": "f67d9b2e_d833474f",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dd6d8a93_018c9693",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1041813
      },
      "writtenOn": "2022-11-07T18:29:38Z",
      "side": 1,
      "message": "build the android14-5.15 branch from one clean environment again with Ulises\u0027s change here(ANDROID: db845c: Remove duplicated modules)\" https://android-review.googlesource.com/c/kernel/common/+/2289394, and the \"ath10k_core: disagrees about version of symbol ieee80211_alloc_hw_nm\" error is still there.\n\nAnd build the android-mainline branch from clean environment as well, it could boot by default without any change, it could boot too with this change + mac80211.ko and cfg80211.ko which either from the gki modules or from the db845c modules.\n\nWhich means the android-mainline GKI mac80211.ko could be used by the db845c ath10k_core.ko, the android14-5.15 GKI mac80211.ko could not be used by the db845c ath10k_core.ko.\n(The ieee80211_alloc_hw_nm function is defined in the mac80211.ko module)\n\ncopy the android14-5.15 failure here for convenience:\n```\n[    2.375377][    T1] init: Loaded kernel module /lib/modules/mac80211.ko\n[    2.382255][    T1] init: Loading module /lib/modules/ath10k_core.ko with args \u0027\u0027\n[    2.394144][    T1] ath10k_core: disagrees about version of symbol ieee80211_alloc_hw_nm\n[    2.402379][    T1] ath10k_core: Unknown symbol ieee80211_alloc_hw_nm (err -22)\n[    2.436823][    T1] init: Failed to insmod \u0027/lib/modules/ath10k_core.ko\u0027 with args \u0027\u0027: Invalid argument\n[    2.446360][    T1] init: LoadWithAliases was unable to load ath10k_core\n[    2.453737][    T1] init: Failed to load kernel modules\n\n```\n\nAny idea what causes the difference here between the android-mainline and the android14-5.15 branches?",
      "parentUuid": "50da9a92_4f4ed43a",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6e2c4de_b6b98a39",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-07T18:48:55Z",
      "side": 1,
      "message": "Ramji works on GKI modules. Ramji, could you PTAL?",
      "parentUuid": "dd6d8a93_018c9693",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bed4beb6_59de231b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-07T18:50:24Z",
      "side": 1,
      "message": "Note: change will also be reverted in https://android-review.git.corp.google.com/c/kernel/build/+/2288499",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67ba5441_1c93908d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2022-11-07T18:52:11Z",
      "side": 1,
      "message": "`android14-5.15` has the KMI symbol lists so, the symbol list `common/android/abi_gki_aarch64_db845c` needs to be updated as it seems outdated.\n\nFor `mainline` since there are no KMI symbol list; http://aosp/2288213 has been added to allow every symbol access.",
      "parentUuid": "dd6d8a93_018c9693",
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "73464cea_eb574e4a",
        "filename": "kleaf/common_kernels.bzl",
        "patchSetId": 1
      },
      "lineNbr": 961,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-07T18:47:26Z",
      "side": 1,
      "message": "These names does not exist in common_kernels.bzl, so it can be different for different branches. Consider passing them in as an argument.",
      "range": {
        "startLine": 961,
        "startChar": 37,
        "endLine": 961,
        "endChar": 49
      },
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dcb5d9e7_136aa3e1",
        "filename": "kleaf/common_kernels.bzl",
        "patchSetId": 1
      },
      "lineNbr": 961,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-07T18:48:04Z",
      "side": 1,
      "message": "That is, please add an argument to `define_db845c` that contains a list of GKI modules to be copied",
      "parentUuid": "73464cea_eb574e4a",
      "range": {
        "startLine": 961,
        "startChar": 37,
        "endLine": 961,
        "endChar": 49
      },
      "revId": "0922a9d5bef4cb84ce7fecc8a916855c216dd8c7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}