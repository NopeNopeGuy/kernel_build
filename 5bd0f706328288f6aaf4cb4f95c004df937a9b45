{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0ca292ac_74afc89a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "Thanks for your contribution! LGTM overall. Please see the following comments.",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2356e11_a2df01c2",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 520,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "Rather than defining this in kernel_build, I would suggest executing the DAMP principle and ask `BUILD.bazel` to declare it.\n\nThat is, please don\u0027t change kernel_build.bzl but rather export `kernel_unarchived_uapi_headers` in `kernel.bzl`",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 34
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5238d2fd_5be0bb41",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 520,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c2356e11_a2df01c2",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 34
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21647dda_9d239bfb",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 520,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T19:09:14Z",
      "side": 1,
      "message": "Applied your suggestion. I also updated my commit message to make it more clear what the end-user has to do to build a cc_binary against the Kleaf UAPI headers. It feels like I just made things more difficult for the end-user... but if that\u0027s the preferred style, we can go with that.",
      "parentUuid": "5238d2fd_5be0bb41",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 34
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dbcdfcb0_5644db84",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 526,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "This is not supported without proper toolchain declaration, so please delete from here.",
      "range": {
        "startLine": 526,
        "startChar": 0,
        "endLine": 526,
        "endChar": 22
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2da96427_dc8e763e",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 526,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dbcdfcb0_5644db84",
      "range": {
        "startLine": 526,
        "startChar": 0,
        "endLine": 526,
        "endChar": 22
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd312b70_3dddba99",
        "filename": "kleaf/impl/kernel_build.bzl",
        "patchSetId": 2
      },
      "lineNbr": 526,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T19:29:28Z",
      "side": 1,
      "message": "Looking a little deeper, since this is a header-only library, I think this works just fine even if no toolchain is available at all. No toolchain commands are invoked when this is built. It simply exposes the headers to the native `cc` interface. After a `bazel clean --expunge`:\n```\nStarting local Bazel server and connecting to it...\nINFO: Analyzed target //\u003ckernel\u003e:\u003cbuild\u003e_uapi_header_library (48 packages loaded, 93895 targets configured).\nINFO: Found 1 target...\nTarget //\u003ckernel\u003e:\u003cbuild\u003e_uapi_header_library up-to-date (nothing to build)\nINFO: Elapsed time: 29.816s, Critical Path: 0.04s\nINFO: 1 process: 1 internal.\nINFO: Build completed successfully, 1 total action\n```\n\nWhy can\u0027t this be supported without proper toolchain declaration?",
      "parentUuid": "2da96427_dc8e763e",
      "range": {
        "startLine": 526,
        "startChar": 0,
        "endLine": 526,
        "endChar": 22
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00ecb407_5c38a4f0",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "AOSP license please",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b560b12_6376c6bd",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1001801
      },
      "writtenOn": "2022-11-11T18:06:39Z",
      "side": 1,
      "message": "This will be tricky for QC. Let\u0027s discuss on bug.",
      "parentUuid": "00ecb407_5c38a4f0",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b19baf2b_969a0b9d",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:08:12Z",
      "side": 1,
      "message": "Okay. Or just leave empty and add license later? I am actually not sure what license is appropriate here...",
      "parentUuid": "6b560b12_6376c6bd",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bf242df5_67c748df",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:08:30Z",
      "side": 1,
      "message": "(I am not a legal expert)",
      "parentUuid": "b19baf2b_969a0b9d",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4f488342_aaff12a4",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T19:00:24Z",
      "side": 1,
      "message": "I think this is resolved. Other 100% QC files that we\u0027ve contributed do not have any markings, so the current state should be correct.",
      "parentUuid": "bf242df5_67c748df",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9be5663a_fca697b1",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 9,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "```\n\"Unpacking UAPI headers {}\".format(ctx.label)\n```\n\n(In case there are multiple of these actions)",
      "range": {
        "startLine": 9,
        "startChar": 27,
        "endLine": 9,
        "endChar": 51
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5b726a6_c61e7be5",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 9,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9be5663a_fca697b1",
      "range": {
        "startLine": 9,
        "startChar": 27,
        "endLine": 9,
        "endChar": 51
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "701680b4_75ccd735",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "Use hermetic tools. Example:\n\nhttps://cs.android.com/android/kernel/superproject/+/common-android-mainline:build/kernel/kleaf/impl/kernel_env.bzl;l\u003d78;drc\u003dd691fc1e1a2213c1ba3b872b988fb49ab7ab8fe8\n\nhttps://cs.android.com/android/kernel/superproject/+/common-android-mainline:build/kernel/kleaf/impl/kernel_env.bzl;l\u003d81;drc\u003dd691fc1e1a2213c1ba3b872b988fb49ab7ab8fe8\n\nhttps://cs.android.com/android/kernel/superproject/+/common-android-mainline:build/kernel/kleaf/impl/kernel_env.bzl;l\u003d331;drc\u003dd691fc1e1a2213c1ba3b872b988fb49ab7ab8fe8",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e4865236_710ef8eb",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "701680b4_75ccd735",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "73bb3b4e_521e3319",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:06:34Z",
      "side": 1,
      "message": "Do you need a realpath though? Why not just $1?\n\nIf you do, once you\u0027ve set up hermetic tools, just use `$(realpath)`. Same below.\n\nnit: Also the convention for Kleaf (not for Bazel in general) is to actually embed them in the script, so something like:\n\n```\n\"\"\"\ntar_file\u003d{input_tar}\n\"\"\".format(input_tar \u003d input_tar.path)\n```\n\nIMO this is clearer than $1",
      "range": {
        "startLine": 13,
        "startChar": 19,
        "endLine": 13,
        "endChar": 30
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e90f6948_c8f9c102",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "73bb3b4e_521e3319",
      "range": {
        "startLine": 13,
        "startChar": 19,
        "endLine": 13,
        "endChar": 30
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1ccd210d_dcfa6370",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 16,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:06:34Z",
      "side": 1,
      "message": "nit: Could you use `-C` in tar to avoid realpath?",
      "range": {
        "startLine": 16,
        "startChar": 33,
        "endLine": 16,
        "endChar": 45
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67675d3f_2acf631a",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 16,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1ccd210d_dcfa6370",
      "range": {
        "startLine": 16,
        "startChar": 33,
        "endLine": 16,
        "endChar": 45
      },
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83f41ff1_ed1ce79c",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 28,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:06:34Z",
      "side": 1,
      "message": "Please mention that usr/include is stripped",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c177f415_83e9c112",
        "filename": "kleaf/impl/kernel_unarchived_uapi_headers.bzl",
        "patchSetId": 2
      },
      "lineNbr": 28,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "83f41ff1_ed1ce79c",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f4e0f5b6_c7b21711",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:01:23Z",
      "side": 1,
      "message": "please export kernel_unarchived_uapi_headers here",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d046acaa_24083217",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-11-11T18:02:02Z",
      "side": 1,
      "message": "(and below)",
      "parentUuid": "f4e0f5b6_c7b21711",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a96b6a4c_55b47b68",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1965070
      },
      "writtenOn": "2022-11-11T18:48:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d046acaa_24083217",
      "revId": "5bd0f706328288f6aaf4cb4f95c004df937a9b45",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}