{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "abc63957_64c4dfeb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T20:32:30Z",
      "side": 1,
      "message": "I don\u0027t see this error message in TH but when I build locally I see:\n\n```\ntar: bad xform\n```\n\nNeed to check which transform expression is not accepted by the toybox tar.",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2563ba0a_df3b74b8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T20:46:45Z",
      "side": 1,
      "message": "It is not happy when archiving the kernel headers:\n\n```\n$ find \u003csandbox_root\u003e/out__common_kernel_aarch64/android-mainline/common -name \u0027*.h\u0027 -print0 | prebuilts/build-tools/path/linux-x86/tar czf /tmp/out-dir-kernel-headers.tar.gz --absolute-names --dereference --transform \u0027s,.*\u003csandbox_root\u003e/out__common_kernel_aarch64/android-mainline/common,,\u0027 --show-transformed  --null -T -\ntar: bad xform\n```",
      "parentUuid": "abc63957_64c4dfeb",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "913e9669_01cef6b7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-08-15T20:49:50Z",
      "side": 1,
      "message": "can you run under strace to see what filename it actually tried to open? (apologies that the diagnostics are so unhelpful here. i\u0027ll pass that on upstream...)",
      "parentUuid": "2563ba0a_df3b74b8",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6fb1da7a_cf7eb7fb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T20:58:45Z",
      "side": 1,
      "message": "I am not sure, but here\u0027s what I see when I try to reproduce it locally:\n\nThe command I am running:\n\n```\n$ find /mnt/sdc/android/kernel/out/bazel/output_user_root/1b6b21355d7d8de5177bf0bcb725bd7f/sandbox/linux-sandbox/11/execroot/__main__/out__common_kernel_aarch64/android-mainline/common -name \u0027*.h\u0027 -print0 | strace prebuilts/build-tools/path/linux-x86/tar czf /tmp/out-dir-kernel-headers.tar.gz --absolute-names --dereference --transform \u0027s,.*/mnt/sdc/android/kernel/out/bazel/output_user_root/1b6b21355d7d8de5177bf0bcb725bd7f/sandbox/linux-sandbox/11/execroot/__main__/out__common_kernel_aarch64/android-mainline/common,,\u0027 --show-transformed  --null -T -\n```\n\nThe last few lines of the strace is:\n\n```\nnewfstatat(AT_FDCWD, \"/mnt/sdc/android/kernel/out/bazel/output_user_root/1b6b21355d7d8de5177bf0bcb725bd7f/sandbox/linux-sandbox/11/execroot/__main__/out__common_kernel_aarch64/android-mainline/common/include/generated/asm-offsets.h\", {st_mode\u003dS_IFREG|0644, st_size\u003d7440, ...}, 0) \u003d 0\npipe([3, 4])                            \u003d 0\npipe([6, 7])                            \u003d 0\nclone(child_stack\u003dNULL, flags\u003dCLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr\u003d0x7fbce9eb6a10) \u003d 456535\nclose(3)                                \u003d 0\nclose(7)                                \u003d 0\nwrite(4, \"/mnt/sdc/android/kernel/out/baze\"..., 209) \u003d 209\nclose(4)                                \u003d 0\nread(6, \"\", 4096)                       \u003d 0\n--- SIGCHLD {si_signo\u003dSIGCHLD, si_code\u003dCLD_EXITED, si_pid\u003d456535, si_uid\u003d406530, si_status\u003d0, si_utime\u003d0, si_stime\u003d0} ---\nclose(6)                                \u003d 0\nwait4(456535, [{WIFEXITED(s) \u0026\u0026 WEXITSTATUS(s) \u003d\u003d 0}], 0, NULL) \u003d 456535\nwrite(2, \"tar: \", 5tar: )                    \u003d 5\nwrite(2, \"bad xform\", 9bad xform)                \u003d 9\nwrite(2, \"\\n\", 1\n```\n\n... So this means it sees an error when executing sed?",
      "parentUuid": "913e9669_01cef6b7",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6dc71bc3_bbb6a5f4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T21:01:58Z",
      "side": 1,
      "message": "How do I know what `sed` command it is trying to execute? All I see before those logs are:\n\n```\nclone(child_stack\u003dNULL, flags\u003dCLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr\u003d0x7fbce9eb6a10) \u003d 456534\nclose(4)                                \u003d 0\nclose(3)                                \u003d 0\n```\n\nbut I don\u0027t see any `exec` etc.",
      "parentUuid": "6fb1da7a_cf7eb7fb",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "543b70de_19636a35",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T21:15:37Z",
      "side": 1,
      "message": "I also notice that, if I run:\n\n```\nfind ... | tar ... -T -\n```\n\nthen it fails with the above error, but if I run\n\n```\ntar ... -T \u003c(find ...)\n```\n\nthen it passes successfully. Not sure why...",
      "parentUuid": "6dc71bc3_bbb6a5f4",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44630a33_566ddb4e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T21:23:59Z",
      "side": 1,
      "message": "Here\u0027s a minimal repro:\n\n```\necho \u003e /tmp/foo.txt; echo /tmp/foo.txt \u003e /tmp/find.txt\n\ncat /tmp/find.txt | prebuilts/build-tools/path/linux-x86/tar czf /tmp/out-dir-kernel-headers.tar.gz --absolute-names --dereference --transform \u0027s,^/,,\u0027 --show-transformed -T -\n```\n\ntoybox tar fails (passes for host tar), but\n\n```\necho \u003e /tmp/foo.txt; echo /tmp/foo.txt \u003e /tmp/find.txt\n\nprebuilts/build-tools/path/linux-x86/tar czf /tmp/out-dir-kernel-headers.tar.gz --absolute-names --dereference --transform \u0027s,^/,,\u0027 --show-transformed -T /tmp/find.txt\n```\n\nThis passes.",
      "parentUuid": "543b70de_19636a35",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f48bf67_8b0177a6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-08-15T21:30:13Z",
      "side": 1,
      "message": "Filed b/242599148",
      "parentUuid": "44630a33_566ddb4e",
      "revId": "548e94d4fd9d66e6f2967c206e40694bf829856b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}