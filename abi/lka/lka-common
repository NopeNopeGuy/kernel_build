#!/bin/bash

in_build_dir()
{
	if [ ! -f vmlinux.o -o \
	     ! -d drivers -o ! -d fs -o ! -d fs -o ! -d net -o \
	     ! -d source/drivers -o ! -d source/fs -o \
	     ! -d source/fs -o ! -d source/net ] ; then
		echo "$CMD: current directory is not Linux build directory" 1>&2
		return 1
	fi
	return 0
}

fold_dots()
{
	sed \
		-e 's?//*?/?g' \
		-e 's?^\./??' \
		-e 's?/\./?/?g' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??' \
		-e 's?/[^/][^/]*/\.\./?/?' -e 's?^[^/][^/]*/\.\./??'
}
