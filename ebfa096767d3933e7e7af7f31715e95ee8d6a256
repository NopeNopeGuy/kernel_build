{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7080bb58_0035c8f7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-30T01:01:08Z",
      "side": 1,
      "message": "Thanks Ramji, this looks pretty good to me!\n\nJust a few more nit comments.",
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "389cb0cd_3c19a454",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2021-12-30T11:36:32Z",
      "side": 1,
      "message": "Thanks for the review. I have addressed all of them. Feel free to point out anything else you may find.",
      "parentUuid": "7080bb58_0035c8f7",
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1aac4349_5c0e3929",
        "filename": "kleaf/common_kernels.bzl",
        "patchSetId": 4
      },
      "lineNbr": 114,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-30T00:54:56Z",
      "side": 1,
      "message": "Since this is essentially empty, maybe file a bug on me to make this optional on kernel_modules_install?\n\nOr is it a placeholder for us to add modules to system_dlkm in the future?",
      "range": {
        "startLine": 114,
        "startChar": 0,
        "endLine": 114,
        "endChar": 63
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e452e614_071b4e24",
        "filename": "kleaf/common_kernels.bzl",
        "patchSetId": 4
      },
      "lineNbr": 114,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-30T00:59:54Z",
      "side": 1,
      "message": "If the latter, please ignore this comment.",
      "parentUuid": "1aac4349_5c0e3929",
      "range": {
        "startLine": 114,
        "startChar": 0,
        "endLine": 114,
        "endChar": 63
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "63b9854a_dc0105d7",
        "filename": "kleaf/common_kernels.bzl",
        "patchSetId": 4
      },
      "lineNbr": 114,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2021-12-30T11:36:32Z",
      "side": 1,
      "message": "All modules in system_dlkm are going to be in-tree modules (i.e. config set to \u003dm in gki_defconfig), so it should be optional in this case as per my understanding. It wasn\u0027t compiling without it; so I added an empty rule here.\n\nFiled Bug: b/212653676",
      "parentUuid": "e452e614_071b4e24",
      "range": {
        "startLine": 114,
        "startChar": 0,
        "endLine": 114,
        "endChar": 63
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd32cf48_a50b010a",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-30T00:59:20Z",
      "side": 1,
      "message": "I don\u0027t think we should check this. The size of the static partition could be different on different devices.\n\nLet userspace build check this.\n\nIf you still think the kernel build should check this, maybe leave a TODO here and let Matthias chime in as well?",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e362d3ab_5898fbe6",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2021-12-30T11:36:32Z",
      "side": 1,
      "message": "With GKI modules, kernel build outputs two things: Kernel Image and system_dlkm.img and they both should have no dependencies on the AOSP code. Since we are stating that partition should be at-least 64MB than we need to make sure we keep the modules image is also \u003c\u003d 64MB. I\u0027ll go with TODO here.",
      "parentUuid": "cd32cf48_a50b010a",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65f2a055_f2e0f72d",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-01-05T05:34:24Z",
      "side": 1,
      "message": "I don\u0027t get this part:\n\n\u003e Since we are stating that partition should be at-least 64MB than we need to make sure we keep the modules image is also \u003c\u003d 64MB.\n\nThis means that the partition could be greater than 64 MB. That is, for some device, they could be building a larger system_dlkm partition, e.g. a 100MB one, and it is perfectly fine for their device.\n\nYour argument seems to be in favor of NOT checking partition sizes here.",
      "parentUuid": "e362d3ab_5898fbe6",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fde34ef3_81c4b5ab",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-01-05T05:35:16Z",
      "side": 1,
      "message": "Matthias, WDYT?",
      "parentUuid": "65f2a055_f2e0f72d",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "43fd5bcb_2556d4a1",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1402878
      },
      "writtenOn": "2022-01-05T16:00:13Z",
      "side": 1,
      "message": "The check should not be part of the rule that produces it if the output is otherwise fine and the limitation is to be found somewhere else. Otherwise we would stop users of this rule using it even if their partition size is sufficient.\n\nWhat can be done is another \"check rule\" that the consuming build implements. I assume that is not yet Bazel then, but soong or Android.mk on the platform side.\n\nBut we should not hard fail here even though we would catch an issue early. But in this case we definitely catch it later if it is an issue. I.e. it is not a subtle issue.",
      "parentUuid": "fde34ef3_81c4b5ab",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01a668ac_eadc7f97",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2022-01-05T23:58:52Z",
      "side": 1,
      "message": "There is no ABI stability between GKI and system_dlkm; so they both needs to be build together and we can\u0027t rely on the platform side for anything; so user can flash the images directly from the kernel build generated files.\n\nI removed the hard fail (exit 1); Removing hard fail will make it easy to miss the size error message; so checking doesn\u0027t make sense anymore. Do you know? I am not sure whether fastboot flashing will protect corrupting the device when flashing files larger than part size. If it is, then we can rely on it. Do you know top of your head?",
      "parentUuid": "43fd5bcb_2556d4a1",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bae3f9db_c9dfab14",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1956,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2022-01-06T04:14:55Z",
      "side": 1,
      "message": "\u003e I am not sure whether fastboot flashing will protect corrupting the device when flashing files larger than part size.\n\nIt will (contact dvander@ to confirm).\n\nRemoving the warning (error) message sounds good to me.",
      "parentUuid": "01a668ac_eadc7f97",
      "range": {
        "startLine": 1956,
        "startChar": 70,
        "endLine": 1956,
        "endChar": 74
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3010f269_288dfae4",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1994,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-30T00:59:20Z",
      "side": 1,
      "message": "nit: you can simplify this text now\n\n```\ncopies `system_dlkm.img` to `$DIST_DIR`\n```",
      "range": {
        "startLine": 1993,
        "startChar": 61,
        "endLine": 1994,
        "endChar": 19
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "55f9145c_fe053787",
        "filename": "kleaf/kernel.bzl",
        "patchSetId": 4
      },
      "lineNbr": 1994,
      "author": {
        "id": 1889091
      },
      "writtenOn": "2021-12-30T11:36:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3010f269_288dfae4",
      "range": {
        "startLine": 1993,
        "startChar": 61,
        "endLine": 1994,
        "endChar": 19
      },
      "revId": "ebfa096767d3933e7e7af7f31715e95ee8d6a256",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}